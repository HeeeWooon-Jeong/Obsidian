```
## 클라이언트가 요청한 정보를 먼저 DB와 대조하고, DB에 해당 정보가 없으면 머신러닝 모델을 사용하여 결과를 생성하고 DB에 저장하는 코드를 작성할 것입니다. 아래는 이러한 작업을 수행하는 Flask 애플리케이션 코드의 예시입니다.  
  
import cx_Oracle  
from pydantic import BaseModel  
from flask import Flask, request, jsonify  
from sklearn.linear_model import LinearRegression  # 머신러닝 모델 예시  
  
# Flask 애플리케이션 생성  
app = Flask(__name__)  
  
# Oracle DB 연결 정보 설정  
db_username = 'your_username'  
db_password = 'your_password'  
db_dsn = 'your_dsn'  # DSN (Data Source Name) 설정  
  
# 모델 정의 (머신러닝 모델 예시)  
class Model(BaseModel):  
    url: str  
  
# 머신러닝 모델 초기화  
ml_model = LinearRegression()  # 머신러닝 모델을 여기에 초기화하십시오.  
  
# URL에서 데이터를 받아 Oracle DB에서 데이터 조회 또는 머신러닝 모델 사용  
@app.route('/url', methods=['POST'])  
def ML():  
    data = request.get_json()  # JSON 데이터를 받아옵니다.  
  
    # Oracle DB 연결  
    connection = cx_Oracle.connect(user=db_username, password=db_password, dsn=db_dsn)  
  
    # 커서 생성  
    cursor = connection.cursor()  
  
    try:  
        # SQL 쿼리 실행  
        sql = "SELECT column_name FROM your_table WHERE url = :url"  
        cursor.execute(sql, url=data['url'])  
  
        # DB에서 결과 가져오기  
        db_result = cursor.fetchone()  
  
        if db_result:  
            # DB에 데이터가 있는 경우 DB 결과를 리턴  
            return jsonify({'result': db_result[0]})  
        else:  
            # DB에 데이터가 없는 경우 머신러닝 모델을 사용하여 결과 생성  
            # 여기에서 머신러닝 모델을 사용하여 결과를 생성하는 코드를 작성하세요.  
            # 결과를 생성하고 DB에 저장하려면 DB 삽입 쿼리를 실행하세요.  
  
            # 머신러닝 모델을 사용한 결과 (예시)  
            ml_result = ml_model.predict([[data['url']]])[0]  
  
            # DB에 결과 저장 (예시)  
            insert_sql = "INSERT INTO your_table (url, result) VALUES (:url, :result)"  
            cursor.execute(insert_sql, url=data['url'], result=ml_result)  
            connection.commit()  
  
            # 결과값 리턴  
            return jsonify({'result': ml_result})  
  
    finally:  
        # 커서와 연결 닫기  
        cursor.close()  
        connection.close()  
  
if __name__ == '__main__':  
    app.run(host='0.0.0.0', port=8000)
```

---
cx_Oracle

빌드툴 설치
https://visualstudio.microsoft.com/ko/visual-cpp-build-tools/

---

```
app = Flask(__name__)  
  
# Oracle 데이터베이스 연결 설정  
app.config['ORACLE_CONNECTION_STRING'] = 'DCLTEST/12345@localhost:1521/DCLTEST'  
  
@app.route('/')  
def hello_world():  
    # Oracle 데이터베이스에 연결  
    connection = cx_Oracle.connect(app.config['ORACLE_CONNECTION_STRING'])  
    cursor = connection.cursor()  
  
    # 쿼리 실행 및 데이터 가져오기  
    cursor.execute('SELECT * FROM TABLE1')  
    data = cursor.fetchall()  
  
    # 연결과 커서 닫기  
    cursor.close()  
    connection.close()  
  
    # 데이터 반환  
    return str(data)  
  
if __name__ == '__main__':  
    app.run()
```

https://justdo-heal.tistory.com/11
10/10 환경설정


---